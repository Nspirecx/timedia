<!DOCTYPE html>
<html>
<title>TiMedia</title>
<link rel="stylesheet" type="text/css" href="style.css">
<body>
<center>
<div class="top">
 <h2 style="color:white;">TiMedia</h2>
 </div>
<br><br>
 <div class="background" id="navbar">
	<a href="index.html"><img draggable=false id="home-icon" style="padding:50px;" width=50px src="home.png"></a>
	<a href="news.html"><img draggable=false id="news-icon" style="padding:50px;" width=50px src="news.png"></a>
	<a href="points.html"><img draggable=false id="money-icon" style="padding:50px;" width=50px src="money.png"></a>
	<a href="settings.html"><img draggable=false id="gears-icon" style="padding:50px;" width=50px src="gears.png"></a>
</div><br><br><br><br><br>
<h3>Redeem</h3>
<img width="500px" src="http://i.imgur.com/ewa0Yck.png"><br>
<input type="text" id="code-input">
<button class="base btn" onclick="checkCode(document.getElementById('code-input').value)">Redeem</button>
</center>
<script>
function isInt(n) {
   return n % 1 === 0;
}

function getCookie(cname) {
    var name = cname + "=";
    var decodedCookie = decodeURIComponent(document.cookie);
    var ca = decodedCookie.split(';');
    for(var i = 0; i <ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}


function checkIfGiftcode(giftcodenum) {
	if (Number(giftcodenum.charAt(0)) + Number(giftcodenum.charAt(1)) + Number(giftcodenum.charAt(2)) + Number(giftcodenum.charAt(3)) + Number(giftcodenum.charAt(4)) + Number(giftcodenum.charAt(5)) + Number(giftcodenum.charAt(6)) + Number(giftcodenum.charAt(7)) + Number(giftcodenum.charAt(8)) + Number(giftcodenum.charAt(9)) == Number(giftcodenum.charAt(3)) * Number(giftcodenum.charAt(4))) {
			if (giftcodenum.charAt(9) == "4") {
					alert("Success! $25 has been credited to your balance.");
				localStorage.points = Number(localStorage.points) + 25;
			} else {
					alert("Success! $10 has been credited to your balance.")
				localStorage.points = Number(localStorage.points) + 10;
			}
} else {
if (Number(getCookie("attempts")) > 3) {
		alert("Too many attempts.");
} else {
	var attempts = Number(getCookie("attempts")) + 1;
	alert("Invalid code.");
  document.cookie = "attempts=" + attempts;
}
}	
}

function checkCode(codenum) {
	if (isInt(codenum) && codenum.length == 10) {
  		checkIfGiftcode(codenum);
  } else {
  	alert("Code must be a 10 digit integer.")	
  }
}
</script>
</body>
</html>
